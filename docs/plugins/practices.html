<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-02T3T29WT5","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><title data-react-helmet="true">Best Practices | Ambient</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://ambientkit.github.io/docs/plugins/practices"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Best Practices | Ambient"><meta data-react-helmet="true" name="description" content="- Use the Ambient logger with all it&#x27;s different levels: error, warn, info, and debug. You shouldn&#x27;t use log or fmt package to output any messages because they are not standardized."><meta data-react-helmet="true" property="og:description" content="- Use the Ambient logger with all it&#x27;s different levels: error, warn, info, and debug. You shouldn&#x27;t use log or fmt package to output any messages because they are not standardized."><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://ambientkit.github.io/docs/plugins/practices"><link data-react-helmet="true" rel="alternate" href="https://ambientkit.github.io/docs/plugins/practices" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://ambientkit.github.io/docs/plugins/practices" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.13296b3d.css">
<link rel="preload" href="/assets/js/runtime~main.f39a10f4.js" as="script">
<link rel="preload" href="/assets/js/main.14a84e68.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/ambient-logo.png" alt="Ambient Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/ambient-logo.png" alt="Ambient Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Ambient</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/introduction/quickstart">Docs</a><a class="navbar__item navbar__link" href="/plugins">Plugin Library</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/ambientkit" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_Pssr toggle_TdHA toggleChecked_cnQY toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">ðŸŒœ</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">ðŸŒž</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" checked="" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/introduction/quickstart">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/architecture/components">Architecture</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" href="/docs/plugins/overview">Plugin Development</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugins/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugins/toolkit">Toolkit</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugins/permissions">Permission System (Grants)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugins/library">Library</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugins/mvp">Your First Plugin (MVP)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugins/types">Plugin Functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugins/logger">Logger</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugins/storage">Storage System</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugins/session">Session Manager</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugins/template-engine">Template Engine</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugins/middleware">Middleware</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugins/router">Router</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugins/routes">Routes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugins/grants">Grant Requests</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugins/settings">Settings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugins/assets">Assets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugins/funcmaps">FuncMaps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugins/enable">Enable &amp; Disable</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugins/grpc">gRPC Compiled Plugins</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugins/docgen">Doc Generation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/plugins/practices">Best Practices</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/cli/amb">CLI</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/template/app">Template</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/faq">FAQ</a></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="theme-doc-markdown markdown"><h1>Best Practices</h1><ul><li>Use the Ambient logger with all it&#x27;s different levels: error, warn, info, and debug. You shouldn&#x27;t use <code>log</code> or <code>fmt</code> package to output any messages because they are not standardized.</li><li>Plugins should not cause the application to halt or exit. They should also return an error where possible.</li><li>If you run background jobs in your plugin, make sure you implement the<code>Enable()</code> function to start the background job and the <code>Disable()</code> function to stop the background job.</li><li>When creating a FuncMap, you must prefix each one with your plugin name and then an underscore - this is to prevent collisions in the templates. A prefix will be added automatically if you don&#x27;t which may cause inconsistencies.</li><li>You must return every permission your plugin needs to use in the <code>GrantRequests()</code> function. Otherwise, the plugin will not be grant access to work properly.</li><li>Routes can be overwritten by other plugins so it&#x27;s best to namespace with the plugin name since plugin names are unique.</li><li>Use <a href="/docs/plugins/middleware#url-path"><code>Path()</code></a> in middleware and <a href="/docs/plugins/funcmaps#global-functions"><code>{{URLPrefix}}</code></a> in HTML templates so you always respect the <code>AMB_URL_PREFIX</code> environment variable. It is already prefixed on routes and assets so you don&#x27;t need to modify them.</li><li>to protect against cross-site request forgery, use <code>p.Site.SetCSRF(r)</code> and <code>p.Site.CSRF(r, r.FormValue(&quot;token&quot;))</code> to set and verify tokens on form submission.</li></ul><p><strong>What should determine the plugin boundary?</strong></p><p>You should group required items together in a plugin. For instance, a session manager should implement both the <code>SessionManager()</code> and <code>Middleware()</code> functions - it wouldn&#x27;t make sense to separate into different plugins since they require each other.</p><p>You could group by feature. A login plugin will have multiple routes (<code>GET /login</code>, <code>POST /login</code>, <code>GET /logout</code>) so those should all be in the same plugin.</p><p>You could group by type as well. You may want to keep most of your middleware or code that modifies your header in the same plugin. For middleware, you may want to group these into a single plugin so you can use a single settings page to enable or disable each one: request logging, trail slash removal, and response gzip compression.</p><p><strong>How should I approach wrapping a package as a plugin?</strong></p><p>Regardless if you&#x27;re using Ambient or not, Go packages should be designed so they can be reused by other people and projects without tightly coupling dependencies. If you are creating a new plugin, build the package so it follows <a href="https://talks.golang.org/2013/bestpractices.slide" target="_blank" rel="noopener noreferrer">Go best practices</a> and then import it to the plugin package. That way you can use it with other apps as well.</p><p><strong>Should I be worried about creating too many plugins?</strong></p><p>If you feel like you have so many plugins that it&#x27;s hard to find what you&#x27;re looking for, it&#x27;s probably too many plugins.</p><p><strong>Does the app run slower with more plugins?</strong></p><p>It will require a bit more startup time as you add plugins, but it shouldn&#x27;t be noticeable.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/ambientkit/ambientkit.github.io/blob/main/docs/plugins/practices.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/plugins/docgen"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Doc Generation</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/cli/amb"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">amb</div></a></div></nav></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Joseph Spurrier. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.f39a10f4.js"></script>
<script src="/assets/js/main.14a84e68.js"></script>
</body>
</html>