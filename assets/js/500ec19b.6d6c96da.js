"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6517],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return d}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),m=p(n),d=a,h=m["".concat(s,".").concat(d)]||m[d]||u[d]||i;return n?r.createElement(h,o(o({ref:t},c),{},{components:n})):r.createElement(h,o({ref:t},c))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var p=2;p<i;p++)o[p]=n[p];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},2374:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return p},toc:function(){return c},default:function(){return m}});var r=n(7462),a=n(3366),i=(n(7294),n(3905)),o=["components"],l={},s="Tookit",p={unversionedId:"plugins/toolkit",id:"plugins/toolkit",title:"Tookit",description:"Almost all plugins have access to a toolkit that gives them access to approved services that they can use. The Toolkit object includes methods from these:",source:"@site/docs/plugins/toolkit.md",sourceDirName:"plugins",slug:"/plugins/toolkit",permalink:"/docs/plugins/toolkit",editUrl:"https://github.com/ambientkit/ambientkit.github.io/blob/main/docs/plugins/toolkit.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Plugins",permalink:"/docs/plugins/overview"},next:{title:"Permission System (Grants)",permalink:"/docs/plugins/permissions"}},c=[{value:"Toolkit Limited Access",id:"toolkit-limited-access",children:[],level:2},{value:"Helpers",id:"helpers",children:[],level:2}],u={toc:c};function m(e){var t=e.components,n=(0,a.Z)(e,o);return(0,i.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"tookit"},"Tookit"),(0,i.kt)("p",null,"Almost all plugins have access to a toolkit that gives them access to approved services that they can use. The Toolkit object includes methods from these:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Logger")," - plugin safe logger with all methods except ",(0,i.kt)("inlineCode",{parentName:"li"},"Fatal()")," since plugins shouldn't be able to terminate the app"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Router")," - plugin safe router with a route recorder so routes can be disabled when a plugin is disabled. It also applies the ",(0,i.kt)("inlineCode",{parentName:"li"},"AMB_URL_PREFIX")," environment variable if set."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Renderer")," - plugin safe template engine that adds a Funcmap of ",(0,i.kt)("inlineCode",{parentName:"li"},"URLPrefix")," to all templates"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"SecureSite")," - plugin safe API for interacting with the application that is governed by the permission system (grants)")),(0,i.kt)("p",null,"Each of the objects above have a layer of abstraction around them to prevent plugins from getting access other exported methods. You can see an example ",(0,i.kt)("a",{parentName:"p",href:"https://go.dev/play/p/zVxZeA3dJ4n"},"here")," where a plugin could potentially convert an object back to it's native type and then have access to any of the exported methods. The layer of abstraction around each object provides protection against this type of attack."),(0,i.kt)("h2",{id:"toolkit-limited-access"},"Toolkit Limited Access"),(0,i.kt)("p",null,"The types of plugins that don't have access to the toolkit are:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Logger")," - it has to be loaded first so it only has access to the app name and app version"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Storage System")," - it only has access to the logger"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Session Manager")," - it only has access to the logger and the session storage, but it's middleware does get access to the Toolkit"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Template Engine")," - it only has access to the logger and the asset injector"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Router")," - it only has access to the logger and the renderer (template engine)")),(0,i.kt)("h2",{id:"helpers"},"Helpers"),(0,i.kt)("p",null,"It also contains these ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/ambientkit/ambient/blob/main/ambient_toolkit.go"},"helper")," functions:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"Redirect(w http.ResponseWriter, r *http.Request, url string, code int)")," - redirects to new URL"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"Path(url string) string")," - returns a URL with proper URL prefix based on the ",(0,i.kt)("inlineCode",{parentName:"li"},"AMB_URL_PREFIX")," environment variable; this should be used in middleware when comparing paths. You can see examples in ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/ambientkit/plugin/blob/main/middleware/notrailingslash/notrailingslash.go"},"notrailingslash")," and ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/ambientkit/plugin/blob/main/middleware/securedashboard/securedashboard.go"},"securedashboard")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"JSON(w http.ResponseWriter, status int, response interface{}) (int, error)")," - convert a struct or map to JSON and then send to the client"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"JSONPretty(w http.ResponseWriter, status int, response interface{}) (int, error)")," - same as JSON, but outputs it with indenting so it's in a more readable format")),(0,i.kt)("p",null,"The Toolkit is passed into plugins via the ",(0,i.kt)("a",{parentName:"p",href:"/docs/plugins/enable"},(0,i.kt)("inlineCode",{parentName:"a"},"Enable()"))," method."))}m.isMDXComponent=!0}}]);